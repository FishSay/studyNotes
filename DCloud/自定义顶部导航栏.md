兼容app、小程序

```vue
// 组件 customNavigation
<!-- 暂时为小程序专用 -->
<template>
    <view>
        <view class="header" :style="headerStyle">
            <view class="header-inner" :style="headeInnerrH">
                <view class="sideView">
                    <view class="defaultLeftIcon" v-if="isCustomLeftIcon" :style="leftIconStyle" v-for="(icon, iconIdx) in leftIcons" :key="iconIdx">
                        <image :src="icon.pic_path" mode="scaleToFill" @tap="onLeftIconsClick(iconIdx)"></image>
                    </view>
                    <view class="defaultLeftIcon" v-else v-for="(icon, iconIdx) in this_leftIcon" :key="iconIdx">
                        <image :src="icon.pic_path" mode="scaleToFill" @tap="onLeftIconsClick(iconIdx)"></image>
                    </view>
                </view>
                <view class="header-title">
                    <image :src="title" mode="scaleToFill" v-if="titleIsImg" :style="titleStyle"></image>
                    <block v-else>{{ title }}</block>
                </view>
                <view class="sideView">
                    <view class="defaultLeftIcon" :style="rightIconStyle" v-for="(icon, iconIdx) in rightIcons" :key="iconIdx">
                        <image :src="icon.pic_path" mode="scaleToFill" @tap="onRightIconsClick(iconIdx)"></image>
                    </view>
                </view>
            </view>
        </view>
    </view>
</template>

<script>
import common from '@/common/common.js';
export default {
    props: {
        bg: {
            type: String,
            default: '#fff'
        },
        leftIcons: Array,
        rightIcons: Array,
        leftIconStyle: String, // leftIcons不为空时有效
        rightIconStyle: String,
        moreLeftIcon: {
            // 左侧是否需要多个按钮, leftIcons为空时有效
            type: Boolean,
            default: false
        },
        titleIsImg: {
            type: Boolean,
            default: false
        },
        title: String,
        titleStyle: String,
        backDelta: {
            type: Number,
            default: 1
        }
    },
    data() {
        return {
            customNavBar: {},
            // #ifdef APP-PLUS
            src: common.src,
            // #endif
            // #ifdef MP
            src: common.localSrc
            // #endif
        };
    },
    computed: {
        this_leftIcon() {
            if (this.moreLeftIcon) {
                return [
                    {
                        pic_path: `${common.src}nav_back.png`
                    },
                    {
                        pic_path: `${common.src}nav_home.png`
                    }
                ];
            } else {
                let pic_path;
                if (this.isHome) {
                    pic_path = `${common.src}nav_home.png`;
                } else {
                    pic_path = `${common.src}nav_back.png`;
                }
                return [
                    {
                        pic_path
                    }
                ];
            }
        },
        isHome() {
            return getCurrentPages().length == 1 ? true : false;
        },
        isCustomLeftIcon() {
            return this.leftIcons.length > 0 ? true : false;
        },
        headerStyle() {
            return this.headerPadd + this.headerBg;
        },
        headerBg() {
            return `background: ${this.bg};`;
        },
        headerPadd() {
            return `padding: ${this.customNavBar.statusH}px 30rpx 0;`;
        },
        headeInnerrH() {
            return `height: ${this.customNavBar.navH}px;`;
        }
    },
    mounted() {
        this.customNavBar = getApp().globalData.customNavBar;
        this.$emit('customNavCallback', {
            headerH: getApp().globalData.customNavBar.navH + getApp().globalData.customNavBar.statusH
        });
    },
    methods: {
        onLeftIconsClick(index) {
            if (this.isCustomLeftIcon) {
                this.$emit('onLeftIconsClick', {
                    index
                });
            } else {
                if (this.isHome) {
                    uni.reLaunch({
                        url: '/pages.index/index'
                    });
                } else {
                    uni.navigateBack({
                        delta: this.backDelta
                    });
                }
            }
        },
        onRightIconsClick(index) {
            this.$emit('onRightIconsClick', {
                index
            });
        }
    }
};
</script>

<style lang="stylus" scoped>
@import '@/common/common.styl'

.header
    position fixed
    top 0
    left 0
    width 100%
    &-inner
        flex-direction row
        align-items center
        justify-content space-between
        ^[0]-title
            font(34)
        .sideView
            flex-direction row
            align-items center
            min-width 130rpx
            .defaultLeftIcon
                width 40rpx
                height @width
                image
                    size(100%, 100%)
                &:not(:first-child)
                    margin-left 50rpx
</style>

```

```js
// 需在app.vue中运行的方法
const getNavHeight = () => {
    // 都是px
     // 获取状态栏高度
    const { windowWidth, statusBarHeight } = uni.getSystemInfoSync();
     
    // #ifdef APP-PLUS
    return {
        navH: 88,
        statusH: statusBarHeight
    };
    // #endif
    // #ifdef MP
    // 得到右上角菜单的位置尺寸
    const menuButtonObject = uni.getMenuButtonBoundingClientRect();
    const { top, height, right } = menuButtonObject;
    
    // 计算导航栏的高度
    // 此高度基于右上角菜单在导航栏位置垂直居中计算得到
    const navBarHeight = height + (top - statusBarHeight) * 2;
    return {
        navH: navBarHeight,
        statusH: statusBarHeight,
        menuButton: {
            top,
            height
        }
    };
    // #endif
};
```

